# Phase B: Business Architecture

**Проект:** Meetup Reservation (монорепозиторий)  
**Методология:** TOGAF ADM  
**Версия:** 1.0  
**Зависимости:** [Phase A: Architecture Vision](./phase-a-architecture-vision.md)

---

## 1. Цели и область Phase B

### 1.1 Цели

- Разработать целевую бизнес-архитектуру (Target Business Architecture), описывающую, как платформа Meetup Reservation должна функционировать для достижения целей из Phase A.
- Описать базовую бизнес-архитектуру (Baseline) — текущее состояние до внедрения системы.
- Выполнить gap-анализ и определить компоненты для Architecture Roadmap.
- Уточнить и детализировать бизнес-требования в Architecture Requirements Specification.

### 1.2 Область (из Phase A)

- Мультитенантная платформа для организации мероприятий.
- Роли: Организатор, Посетитель (участник), Администратор платформы.
- Функциональность: создание событий, регистрация, управление участниками, администрирование, уведомления.

---

## 2. Baseline Business Architecture (текущее состояние)

### 2.1 Описание

До внедрения Meetup Reservation организация мероприятий осуществляется вручную или с использованием разрозненных инструментов (таблицы, email, сторонние сервисы).

| Аспект | Baseline (текущее состояние) |
|--------|-----------------------------|
| **Создание событий** | Ручное: документы, таблицы, рассылки вручную |
| **Регистрация участников** | Email, формы Google, таблицы; дублирование и ошибки |
| **Оплата** | Отдельные системы или наличные; нет единого учёта |
| **Уведомления** | Ручные рассылки, риск пропуска |
| **Чек-ин** | Списки на бумаге или в таблицах |
| **Отчётность** | Ручной сбор и экспорт данных |
| **Мультитенантность** | Отсутствует; каждый организатор использует свои инструменты |
| **Модерация** | Нет централизованного контроля |

### 2.2 Ключевые ограничения Baseline

- Высокие операционные затраты на ручные операции.
- Риск потери данных и дублирования регистраций.
- Отсутствие единого каталога и поиска событий.
- Нет автоматических напоминаний участникам.
- Сложность масштабирования при росте числа мероприятий.

---

## 3. Target Business Architecture (целевое состояние)

### 3.1 Business Capability Map

| ID | Capability | Описание | Владелец |
|----|------------|----------|----------|
| BC-01 | **Управление учётными записями** | Регистрация, авторизация, профили пользователей (организаторы, участники, администраторы) | Платформа |
| BC-02 | **Управление категориями** | Создание и редактирование категорий событий | Администратор |
| BC-03 | **Управление событиями** | Создание, публикация, отмена событий; типы билетов; публичность | Организатор |
| BC-04 | **Управление каталогом** | Единый каталог, страницы организаторов, поиск, фильтрация | Платформа |
| BC-05 | **Регистрация на мероприятия** | Регистрация участников (гости и зарегистрированные), выбор билета, оплата (заглушка) | Участник |
| BC-06 | **Управление участниками** | Список участников, ручная отметка чек-ина, отмена регистраций | Организатор |
| BC-07 | **Уведомления** | Email: подтверждение регистрации, напоминания, отмена события | Платформа |
| BC-08 | **Экспорт данных** | Экспорт списка участников в Excel/PDF | Организатор |
| BC-09 | **Модерация** | Постмодерация событий, блокировка организаторов и пользователей | Администратор |
| BC-10 | **Личный кабинет участника** | «Мои регистрации», отмена своей регистрации | Участник |

### 3.2 Value Stream Map

**Value Stream: «Участие в мероприятии»**

| Этап | Действие | Участник | Результат |
|------|----------|----------|-----------|
| 1 | Поиск события | Посетитель | Найденное событие |
| 2 | Выбор билета и ввод данных | Посетитель | Заполненная форма |
| 3 | Оплата (или пропуск для бесплатных) | Посетитель | Подтверждение регистрации |
| 4 | Получение подтверждения | Посетитель | Email с данными регистрации |
| 5 | Посещение и чек-ин | Организатор + Посетитель | Отмеченное присутствие |
| 6 | Экспорт отчёта | Организатор | Excel/PDF со списком |

**Value Stream: «Организация мероприятия»**

| Этап | Действие | Участник | Результат |
|------|----------|----------|-----------|
| 1 | Регистрация/вход | Организатор | Учётная запись |
| 2 | Создание события | Организатор | Опубликованное событие |
| 3 | Управление регистрациями | Организатор | Список участников |
| 4 | Чек-ин на мероприятии | Организатор | Отмеченные участники |
| 5 | Экспорт данных | Организатор | Отчёт |

### 3.3 Organization / Actor Catalog

| Actor | Роль | Описание |
|-------|------|----------|
| **Организатор** | Создатель события | Регистрируется на платформе, создаёт события, управляет участниками, имеет публичный профиль |
| **Посетитель (зарегистрированный)** | Участник с учётной записью | Имеет личный кабинет «Мои регистрации», автозаполнение данных, может отменить регистрацию |
| **Посетитель (гость)** | Участник без учётной записи | Вводит данные при каждой регистрации, не может отменить в первой версии |
| **Администратор платформы** | Оператор системы | Модерация, блокировка, управление пользователями и категориями; создаётся через скрипт |

### 3.4 Actor/Role Matrix

| Функция | Организатор | Участник (зарег.) | Участник (гость) | Администратор |
|---------|:-----------:|:-----------------:|:----------------:|:-------------:|
| Регистрация на платформе | ✓ | ✓ | — | — |
| Создание события | ✓ | — | — | — |
| Просмотр каталога | ✓ | ✓ | ✓ | ✓ |
| Регистрация на мероприятие | ✓ | ✓ | ✓ | — |
| Личный кабинет | — | ✓ | — | — |
| Отмена своей регистрации | — | ✓ | — | — |
| Управление участниками | ✓ | — | — | — |
| Чек-ин (ручная отметка) | ✓ | — | — | — |
| Экспорт Excel/PDF | ✓ | — | — | — |
| Отмена события | ✓ | — | — | — |
| Модерация событий/организаторов | — | — | — | ✓ |
| Управление пользователями | — | — | — | ✓ |
| Управление категориями | — | — | — | ✓ |

### 3.5 Business Process Descriptions

#### BP-01: Создание и публикация события (Организатор)

1. Организатор входит в систему.
2. Создаёт событие: название, описание, дата/время, место (онлайн/офлайн), категория, публичность.
3. Добавляет типы билетов (название, цена, вместимость).
4. Загружает фото и программу (опционально).
5. Публикует событие.
6. Событие появляется в каталоге (если публичное) или доступно по ссылке (если приватное).

**Ограничения:** редактирование после публикации не предусмотрено; клонирование — не в первой версии.

#### BP-02: Регистрация на мероприятие (Посетитель)

1. Посетитель находит событие (каталог или страница организатора).
2. Выбирает тип билета.
3. Вводит данные (ФИО, email, телефон) или использует автозаполнение (если зарегистрирован).
4. Для платных билетов: проходит шаг оплаты (заглушка).
5. Для бесплатных: регистрация завершается сразу.
6. Получает подтверждение по email.

**Правила:** один email — один билет на событие; один участник — один билет (в первой версии).

#### BP-03: Управление участниками и чек-ин (Организатор)

1. Организатор открывает список участников события.
2. На мероприятии вручную отмечает участников (чек-ин).
3. Может отменить регистрацию участника.
4. Экспортирует список в Excel/PDF.

#### BP-04: Отмена события (Организатор)

1. Организатор отменяет событие.
2. Система аннулирует все регистрации.
3. Участники получают уведомление по email.
4. Событие скрывается из каталога, но доступно по прямой ссылке с пометкой «отменено».

#### BP-05: Модерация (Администратор)

1. Администратор просматривает события и организаторов.
2. При необходимости блокирует событие (скрыто, доступно по ссылке) или организатора.
3. При блокировке организатора все его события отменяются, участники получают уведомление.
4. Управляет пользователями (просмотр, блокировка).
5. Добавляет и редактирует категории.

#### BP-06: Отмена регистрации участником

1. Зарегистрированный участник входит в личный кабинет.
2. Выбирает регистрацию для отмены.
3. Подтверждает отмену.
4. Организатор получает уведомление.

**Ограничение:** гость не может отменить в первой версии.

### 3.6 Business Function Decomposition

```
Meetup Reservation — Business Functions
│
├── Управление пользователями
│   ├── Регистрация организатора
│   ├── Регистрация участника
│   ├── Авторизация
│   └── Профиль организатора (публичный)
│
├── Управление контентом
│   ├── Управление категориями (админ)
│   ├── Создание события
│   └── Публикация события
│
├── Каталог и поиск
│   ├── Единый каталог
│   ├── Страница организатора
│   ├── Поиск и фильтрация
│   └── Отображение статуса (активно/завершено/отменено)
│
├── Регистрация на мероприятия
│   ├── Выбор билета
│   ├── Ввод/автозаполнение данных
│   ├── Оплата (заглушка)
│   └── Подтверждение
│
├── Управление участниками
│   ├── Список участников
│   ├── Ручная отметка чек-ина
│   ├── Отмена регистрации
│   └── Экспорт Excel/PDF
│
├── Уведомления
│   ├── Подтверждение регистрации
│   ├── Напоминания (день/час)
│   └── Уведомление об отмене
│
├── Личный кабинет участника
│   ├── Мои регистрации
│   └── Отмена своей регистрации
│
└── Администрирование
    ├── Модерация событий
    ├── Блокировка организаторов
    ├── Управление пользователями
    └── Управление категориями
```

---

## 4. Gap Analysis

### 4.1 Сводная таблица разрывов

| # | Baseline | Target | Gap | Приоритет |
|---|----------|--------|-----|-----------|
| G1 | Ручное создание событий | Платформа с формами, типами билетов, категориями | Новая система | Высокий |
| G2 | Разрозненные регистрации | Единая регистрация с проверкой дублей | Новая система | Высокий |
| G3 | Ручные уведомления | Автоматические email-уведомления | Новая система | Высокий |
| G4 | Бумажные списки / таблицы | Цифровой чек-ин, экспорт Excel/PDF | Новая система | Высокий |
| G5 | Нет каталога | Единый каталог с поиском и фильтрами | Новая система | Высокий |
| G6 | Нет мультитенантности | Изоляция данных по организаторам | Новая система | Высокий |
| G7 | Нет модерации | Постмодерация, блокировка | Новая система | Средний |
| G8 | Нет личного кабинета участника | «Мои регистрации», отмена | Новая система | Средний |

### 4.2 Выводы

- Проект **greenfield**: Baseline — отсутствие специализированной платформы.
- Все целевые возможности требуют **создания с нуля**.
- Нет миграции данных из существующих систем.

---

## 5. Architecture Requirements Specification

### 5.1 Функциональные требования (детализированные)

#### FR-01: Управление учётными записями

| ID | Требование | Приоритет |
|----|------------|-----------|
| FR-01.1 | Регистрация организатора (email, пароль, данные профиля) | Must |
| FR-01.2 | Регистрация участника (опционально) | Must |
| FR-01.3 | Авторизация по email/паролю | Must |
| FR-01.4 | Публичный профиль организатора (название, описание, аватар) | Must |
| FR-01.5 | Создание первого администратора через скрипт | Must |
| FR-01.6 | Восстановление пароля | Won't (след. фаза) |
| FR-01.7 | Подтверждение email | Won't (след. фаза) |

#### FR-02: Управление событиями

| ID | Требование | Приоритет |
|----|------------|-----------|
| FR-02.1 | Создание события: название, описание, дата/время, место, категория | Must |
| FR-02.2 | Публичность: публичное / приватное (по ссылке) | Must |
| FR-02.3 | Несколько типов билетов (название, цена, вместимость) | Must |
| FR-02.4 | Загрузка фото и программы | Must |
| FR-02.5 | Отмена события с уведомлением участников | Must |
| FR-02.6 | Редактирование после публикации | Won't |
| FR-02.7 | Клонирование события | Won't (след. фаза) |

#### FR-03: Каталог и поиск

| ID | Требование | Приоритет |
|----|------------|-----------|
| FR-03.1 | Единый каталог публичных событий | Must |
| FR-03.2 | Поиск и фильтрация по категориям | Must |
| FR-03.3 | Страница организатора с его событиями | Must |
| FR-03.4 | Отменённые/заблокированные — скрыты, доступны по ссылке | Must |
| FR-03.5 | Прошедшие события с пометкой «завершено» | Must |
| FR-03.6 | Доступ неавторизованного посетителя к каталогу | Must |

#### FR-04: Регистрация на мероприятия

| ID | Требование | Приоритет |
|----|------------|-----------|
| FR-04.1 | Выбор типа билета | Must |
| FR-04.2 | Ввод данных (ФИО, email, телефон) для гостей | Must |
| FR-04.3 | Автозаполнение для зарегистрированных | Must |
| FR-04.4 | Запрет дублирования (один email — один билет) | Must |
| FR-04.5 | Оплата-заглушка для платных билетов | Must |
| FR-04.6 | Пропуск оплаты для бесплатных билетов | Must |
| FR-04.7 | Подтверждение по email | Must |
| FR-04.8 | Один участник — один билет на событие | Must |
| FR-04.9 | Промокоды/скидки | Won't (след. фаза) |

#### FR-05: Управление участниками

| ID | Требование | Приоритет |
|----|------------|-----------|
| FR-05.1 | Список участников события | Must |
| FR-05.2 | Ручная отметка чек-ина | Must |
| FR-05.3 | Отмена регистрации организатором | Must |
| FR-05.4 | Экспорт в Excel/PDF (ФИО, email, телефон, статус чек-ина) | Must |
| FR-05.5 | Чек-ин по QR | Won't (след. фаза) |

#### FR-06: Личный кабинет участника

| ID | Требование | Приоритет |
|----|------------|-----------|
| FR-06.1 | Просмотр «Мои регистрации» | Must |
| FR-06.2 | Отмена своей регистрации (с уведомлением организатора) | Must |
| FR-06.3 | Отмена регистрации гостем | Won't (след. фаза) |

#### FR-07: Уведомления

| ID | Требование | Приоритет |
|----|------------|-----------|
| FR-07.1 | Email: подтверждение регистрации | Must |
| FR-07.2 | Email: напоминания за день и за час | Must |
| FR-07.3 | Email: уведомление об отмене события | Must |
| FR-07.4 | Email: уведомление при отмене участником | Must |
| FR-07.5 | SMS | Won't (след. фаза) |

#### FR-08: Администрирование

| ID | Требование | Приоритет |
|----|------------|-----------|
| FR-08.1 | Постмодерация: блокировка события | Must |
| FR-08.2 | Блокировка организатора (все события отменяются, уведомления) | Must |
| FR-08.3 | Управление пользователями: просмотр, блокировка | Must |
| FR-08.4 | Управление категориями: добавление, редактирование | Must |

#### FR-09: Бизнес-правила

| ID | Требование | Приоритет |
|----|------------|-----------|
| FR-09.1 | Ограничение мест: закрытие регистрации при заполнении | Must |
| FR-09.2 | Лимиты по каждому типу билета | Must |
| FR-09.3 | Список ожидания (waitlist) | Won't (след. фаза) |

### 5.2 Нефункциональные требования

| ID | Категория | Требование |
|----|-----------|------------|
| NFR-01 | Производительность | Система выдерживает типичную нагрузку регистраций |
| NFR-02 | Безопасность | Защита персональных данных |
| NFR-03 | Доступность | Веб-интерфейс на основных браузерах |
| NFR-04 | Локализация | Только русский язык |
| NFR-05 | Поддерживаемость | Монорепозиторий, разделение backend/frontend |

---

## 6. Candidate Roadmap Components

Компоненты для включения в Architecture Roadmap (Phase E):

| # | Компонент | Описание | Зависимости |
|---|------------|----------|-------------|
| RC-1 | Backend API | ASP.NET Core, PostgreSQL, SQL-скрипты | — |
| RC-2 | Frontend SPA | React + TypeScript + Vite | RC-1 |
| RC-3 | Аутентификация и авторизация | JWT/сессии, роли | RC-1 |
| RC-4 | Модуль событий | CRUD, типы билетов, категории | RC-1, RC-3 |
| RC-5 | Модуль регистраций | Регистрация, проверка дублей, оплата-заглушка | RC-1, RC-4 |
| RC-6 | Модуль уведомлений | Email-сервис | RC-1 |
| RC-7 | Модуль администрирования | Модерация, управление пользователями и категориями | RC-1, RC-3 |
| RC-8 | Экспорт Excel/PDF | Генерация отчётов | RC-1 |

---

## 7. Связь с Phase A

| Phase A | Phase B |
|---------|---------|
| Stakeholders, модель пользователей | Actor/Role catalog, Actor/Role matrix |
| High-level требования | Architecture Requirements Specification (детализированные FR/NFR) |
| Scope, принципы | Business Capabilities, Business Processes |
| Цели и ценность | Value Stream Map |
| Out of Scope / Следующие фазы | Won't в Requirements, Candidate Roadmap |

---

## 8. Утверждение

| Роль | Статус | Дата |
|------|--------|------|
| Владелец продукта | Ожидает | — |
| Архитектор | Ожидает | — |
| Бизнес-аналитик | Ожидает | — |

---

*Документ подготовлен в формате TOGAF Phase B (Business Architecture) на основе [Phase A: Architecture Vision](./phase-a-architecture-vision.md).*
